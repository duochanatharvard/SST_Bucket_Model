You need m_map toolbox to run this model, which can be found here:
https://www.eoas.ubc.ca/~rich/map.html
 
Also, smooth3CD,  conv2nan,
